(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=jQuery;var n=e.n(t);const o=["id","class","style","title","accesskey","tabindex","lang","dir","draggable","dropzone","contextmenu","hidden"].join("|"),a=["onclick"].join("|"),i=[];async function s(e){let t=null,s="";const r=document.getElementById(e.dataset.target),c=document.createElement("TEXTAREA");c.id=e.dataset.target+"-mt-be";const d=document.createElement("DIV");d.classList.add("mt-block-editor-wrap"),d.appendChild(c),i.push((async()=>{if(t)return t.serialize().then((()=>{r.value=c.value}))}));const l=e.id.match(/(\d+)$/)[1],u=JSON.parse(document.getElementById("be-field-data").value);async function m(){const n=s;if(s=e.value,"block_editor"===e.value){c.value=r.value,e.closest(".mt-contentblock").appendChild(d);const n={id:c.id,mode:"composition",rootAttributes:{"data-content-type-name":u.content_type.name,"data-content-type-unique-id":u.content_type.unique_id,"data-field-name":u.fields[l].name,"data-field-unique-id":u.fields[l].unique_id}};!function(e,t){const n=document.getElementById("mt-block-editor-loader"),o=n?.dataset;if(!o)return;const a=JSON.parse(o.mtBlockDisplayOptionsMap||"{}")[e]||null;let i=[],s=[];if(a){const e=JSON.parse(a),t=JSON.parse(o.mtBlockTypeIds||"[]");e.common.forEach((e=>{const n=t.indexOf(e.typeId);-1!==n&&t.splice(n,1),e.shortcut&&s.push(e.typeId),e.panel&&i.push(e.typeId)})),i.push(...t)}else i=JSON.parse(o.mtBlockTypeIds||"[]"),s=i.slice(0,parseInt(o.mtBlockEditorShortcutCountDefault||"",10));Object.assign(t,{panelBlockTypes:i,shortcutBlockTypes:s})}(document.getElementById(`content-field-${l}-be_config`).value,n),function(e){const t=window.MT?.Editor?.defaultCommonOptions||{};if(t.content_css_list&&(e.stylesheets=t.content_css_list),t.body_class_list){const n=t.body_class_list.filter((e=>"wysiwyg"!==e));e.rootClassName=n.join(" ")}}(n),window.MTBlockEditor&&window.MTBlockEditor.isSupportedEnvironment()?t=await function(e){function t({editor:e}){window.setDirty&&window.setDirty(!0),window.app&&window.app.getIndirectMethod("setDirty")(),e.off("change",t)}const n={i18n:{lng:document.querySelector("html")?.getAttribute("lang")},block:{"sixapart-oembed":{resolver:async({url:e,maxwidth:t,maxheight:n})=>{const o=await(await fetch(window.CMSScriptURI+"?"+new URLSearchParams({__mode:"mt_be_oembed",url:e,maxwidth:t||"",maxheight:n||""}))).json();if(o.error?.message)throw new Error(o.error.message);return o}}}},i="tinyMCEDefaultSettings"in e?e.tinyMCEDefaultSettings:{convert_urls:!1,entities:"160,nbsp",entity_encoding:"named",valid_children:"+a[video|ul|time|table|svg|style|section|ruby|progress|pre|output|ol|noscript|nav|meter|meta|menu|mark|link|keygen|hr|hgroup|header|h6|h5|h4|h3|h2|h1|form|footer|figure|fieldset|embed|dl|div|dialog|details|datalist|command|canvas|blockquote|audio|aside|article|address|area]"},s=Object.assign({},n.block,e.block||{}),r=Object.assign({},n,e,{block:s});return r.stylesheets=r.stylesheets||[],window.MTBlockEditor?.apply(r).then((e=>{e.on("buildTinyMCESettings",(({settings:e})=>{Object.assign(e,i),e.extended_valid_elements=[`a[${o}|${a}|href|target|name]`,`span[${o}|${a}]`,"script[id|name|type|src|integrity|crossorigin]"].join(",")})),e.on("change",t);const n=document.getElementById("mt-block-editor-loader"),s=n?.dataset?.mtBlockEditorIframeBaseUrl;return s&&e.on("beforeRenderIframePreview",(e=>{const t=document.createElement("base");t.href=s,e.head=t.outerHTML+e.head})),e}))}(n):d.innerHTML=`\n        <div class="card m-5"><div class="card-body">\n        ${window.trans("This format does not support this web browser. Please switch to another format.")}\n        </div></div>\n        `,e.closest(".mt-contentblock").querySelector(".editor-content").classList.add("d-none")}else"block_editor"===n&&(await(i={id:c.id},window.MTBlockEditor?window.MTBlockEditor.unload(i):Promise.resolve()),t=null,r.value=c.value,d.remove(),e.closest(".mt-contentblock").querySelector(".editor-content").classList.remove("d-none"));var i}e.addEventListener("change",(t=>{t.isTrusted&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault(),m().then((()=>{n()(e).trigger("change")})))})),m()}(()=>{const e=document.querySelectorAll(".custom-select.convert_breaks");if(0===e.length)return;const t=e[0].form;e.forEach(s),t.querySelectorAll('button[type="submit"]').forEach((e=>{!function(e,t){let n=!1;e.addEventListener("click",(o=>{n?n=!1:(o.stopImmediatePropagation(),o.stopPropagation(),o.preventDefault(),Promise.all(t.map((e=>e()))).then((()=>{n=!0,e.click()})))}),{capture:!0})}(e,i)}))})()})();